Title: Hessian matrix
Aspects: {'H-matrix'}

In mathematics, the Hessian matrix or Hessian is a square matrix of second-order partial derivatives of a scalar-valued function, or scalar field. It describes the local curvature of a function of many variables. The Hessian matrix was developed in the 19th century by the German mathematician Ludwig Otto Hesse and later named after him. Hesse originally used the term "functional determinants".


== Definitions and properties ==
Suppose f : ℝn → ℝ is a function taking as input a vector x ∈ ℝn and outputting a scalar f(x) ∈ ℝ; if all second partial derivatives of f exist and are continuous over the domain of the function, then the Hessian matrix H of f is a square n×n matrix, usually defined and arranged as follows:

  
    
      
        
          H
        
        =
        
          
            [
            
              
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          f
                        
                        
                          ∂
                          
                            x
                            
                              1
                            
                            
                              2
                            
                          
                        
                      
                    
                  
                
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          f
                        
                        
                          ∂
                          
                            x
                            
                              1
                            
                          
                          
                          ∂
                          
                            x
                            
                              2
                            
                          
                        
                      
                    
                  
                
                
                  ⋯
                
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          f
                        
                        
                          ∂
                          
                            x
                            
                              1
                            
                          
                          
                          ∂
                          
                            x
                            
                              n
                            
                          
                        
                      
                    
                  
                
              
              
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          f
                        
                        
                          ∂
                          
                            x
                            
                              2
                            
                          
                          
                          ∂
                          
                            x
                            
                              1
                            
                          
                        
                      
                    
                  
                
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          f
                        
                        
                          ∂
                          
                            x
                            
                              2
                            
                            
                              2
                            
                          
                        
                      
                    
                  
                
                
                  ⋯
                
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          f
                        
                        
                          ∂
                          
                            x
                            
                              2
                            
                          
                          
                          ∂
                          
                            x
                            
                              n
                            
                          
                        
                      
                    
                  
                
              
              
                
                  ⋮
                
                
                  ⋮
                
                
                  ⋱
                
                
                  ⋮
                
              
              
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          f
                        
                        
                          ∂
                          
                            x
                            
                              n
                            
                          
                          
                          ∂
                          
                            x
                            
                              1
                            
                          
                        
                      
                    
                  
                
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          f
                        
                        
                          ∂
                          
                            x
                            
                              n
                            
                          
                          
                          ∂
                          
                            x
                            
                              2
                            
                          
                        
                      
                    
                  
                
                
                  ⋯
                
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          f
                        
                        
                          ∂
                          
                            x
                            
                              n
                            
                            
                              2
                            
                          
                        
                      
                    
                  
                
              
            
            ]
          
        
        .
      
    
    {\displaystyle \mathbf {H} ={\begin{bmatrix}{\dfrac {\partial ^{2}f}{\partial x_{1}^{2}}}&{\dfrac {\partial ^{2}f}{\partial x_{1}\,\partial x_{2}}}&\cdots &{\dfrac {\partial ^{2}f}{\partial x_{1}\,\partial x_{n}}}\\[2.2ex]{\dfrac {\partial ^{2}f}{\partial x_{2}\,\partial x_{1}}}&{\dfrac {\partial ^{2}f}{\partial x_{2}^{2}}}&\cdots &{\dfrac {\partial ^{2}f}{\partial x_{2}\,\partial x_{n}}}\\[2.2ex]\vdots &\vdots &\ddots &\vdots \\[2.2ex]{\dfrac {\partial ^{2}f}{\partial x_{n}\,\partial x_{1}}}&{\dfrac {\partial ^{2}f}{\partial x_{n}\,\partial x_{2}}}&\cdots &{\dfrac {\partial ^{2}f}{\partial x_{n}^{2}}}\end{bmatrix}}.}
  or, by stating an equation for the coefficients using indices i and j:

  
    
      
        
          
            H
          
          
            i
            ,
            j
          
        
        =
        
          
            
              
                ∂
                
                  2
                
              
              f
            
            
              ∂
              
                x
                
                  i
                
              
              ∂
              
                x
                
                  j
                
              
            
          
        
        .
      
    
    {\displaystyle \mathbf {H} _{i,j}={\frac {\partial ^{2}f}{\partial x_{i}\partial x_{j}}}.}
  The determinant of the above matrix is also sometimes referred to as the Hessian.The Hessian matrix is related to the Jacobian matrix by H(f(x)) = J(∇f(x))T.
The mixed partial derivatives of f are the entries off the main diagonal in the Hessian. Assuming that they are continuous in a neighborhood of a given point, the order of differentiation does not matter (Schwarz's theorem). Thus,

  
    
      
        
          
            ∂
            
              ∂
              
                x
                
                  i
                
              
            
          
        
        
          (
          
            
              
                ∂
                f
              
              
                ∂
                
                  x
                  
                    j
                  
                
              
            
          
          )
        
        =
        
          
            ∂
            
              ∂
              
                x
                
                  j
                
              
            
          
        
        
          (
          
            
              
                ∂
                f
              
              
                ∂
                
                  x
                  
                    i
                  
                
              
            
          
          )
        
        .
      
    
    {\displaystyle {\frac {\partial }{\partial x_{i}}}\left({\frac {\partial f}{\partial x_{j}}}\right)={\frac {\partial }{\partial x_{j}}}\left({\frac {\partial f}{\partial x_{i}}}\right).}
  In a formal statement: if the second partial derivatives of f are all continuous in a neighborhood D of a given point, then the Hessian of f is a symmetric matrix throughout D; see symmetry of second derivatives.


== Applications ==


=== Second derivative test ===

The Hessian matrix of a convex function is positive semi-definite. Refining this property allows us to test if a critical point x is a local maximum, local minimum, or a saddle point, as follows:
If the Hessian is positive definite at x, then f attains an isolated local minimum at x. If the Hessian is negative definite at x, then f attains an isolated local maximum at x. If the Hessian has both positive and negative eigenvalues then x is a saddle point for f. Otherwise the test is inconclusive. This implies that at a local minimum the Hessian is positive-semi-definite, and at a local maximum the Hessian is negative semi-definite.
Note that for positive semidefinite and negative semidefinite Hessians the test is inconclusive (a critical point where the Hessian is semidefinite but not definite may be a local extremum or a saddle point). However, more can be said from the point of view of Morse theory.
The second derivative test for functions of one and two variables is simple. In one variable, the Hessian contains just one second derivative; if it is positive then x is a local minimum, and if it is negative then x is a local maximum; if it is zero then the test is inconclusive. In two variables, the determinant can be used, because the determinant is the product of the eigenvalues. If it is positive then the eigenvalues are both positive, or both negative. If it is negative then the two eigenvalues have different signs. If it is zero, then the second derivative test is inconclusive.
Equivalently, the second-order conditions that are sufficient for a local minimum or maximum can be expressed in terms of the sequence of principal (upper-leftmost) minors (determinants of sub-matrices) of the Hessian; these conditions are a special case of those given in the next section for bordered Hessians for constrained optimization—the case in which the number of constraints is zero. Specifically, the sufficient condition for a minimum is that all of these principal minors be positive, while the sufficient condition for a maximum is that the minors alternate in sign with the 1×1 minor being negative.


=== Critical points ===
If the gradient (the vector of the partial derivatives) of a function f is zero at some point x, then f has a critical point (or stationary point) at x. The determinant of the Hessian at x is then called the discriminant. If this determinant is zero then x is called a degenerate critical point of f, or a non-Morse critical point of f. Otherwise it is non-degenerate, and called a Morse critical point of f.
The Hessian matrix plays an important role in Morse theory and catastrophe theory, because its kernel and eigenvalues allow classification of the critical points.


=== Use in optimization ===
Hessian matrices are used in large-scale optimization problems within Newton-type methods because they are the coefficient of the quadratic term of a local Taylor expansion of a function. That is,

  
    
      
        y
        =
        f
        (
        
          x
        
        +
        Δ
        
          x
        
        )
        ≈
        f
        (
        
          x
        
        )
        +
        ∇
        f
        (
        
          x
        
        
          )
          
            
              T
            
          
        
        Δ
        
          x
        
        +
        
          
            1
            2
          
        
        Δ
        
          
            x
          
          
            
              T
            
          
        
        
          H
        
        (
        
          x
        
        )
        Δ
        
          x
        
      
    
    {\displaystyle y=f(\mathbf {x} +\Delta \mathbf {x} )\approx f(\mathbf {x} )+\nabla f(\mathbf {x} )^{\mathrm {T} }\Delta \mathbf {x} +{\frac {1}{2}}\Delta \mathbf {x} ^{\mathrm {T} }\mathbf {H} (\mathbf {x} )\Delta \mathbf {x} }
  where ∇f is the gradient (∂f/∂x1, ..., ∂f/∂xn). Computing and storing the full Hessian matrix takes Θ(n2) memory, which is infeasible for high-dimensional functions such as the loss functions of neural nets, conditional random fields, and other statistical models with large numbers of parameters. For such situations, truncated-Newton and quasi-Newton algorithms have been developed. The latter family of algorithms use approximations to the Hessian; one of the most popular quasi-Newton algorithms is BFGS.Such approximations may use the fact that an optimization algorithm uses the Hessian only as a linear operator H(v), and proceed by first noticing that the Hessian also appears in the local expansion of the gradient:

  
    
      
        ∇
        f
        (
        
          x
        
        +
        Δ
        
          x
        
        )
        =
        ∇
        f
        (
        
          x
        
        )
        +
        
          H
        
        (
        
          x
        
        )
        Δ
        
          x
        
        +
        
          
            O
          
        
        (
        ‖
        Δ
        
          x
        
        
          ‖
          
            2
          
        
        )
      
    
    {\displaystyle \nabla f(\mathbf {x} +\Delta \mathbf {x} )=\nabla f(\mathbf {x} )+\mathbf {H} (\mathbf {x} )\Delta \mathbf {x} +{\mathcal {O}}(\|\Delta \mathbf {x} \|^{2})}
  Letting Δx = rv for some scalar r, this gives

  
    
      
        
          H
        
        (
        
          x
        
        )
        Δ
        
          x
        
        =
        
          H
        
        (
        
          x
        
        )
        r
        
          v
        
        =
        r
        
          H
        
        (
        
          x
        
        )
        
          v
        
        =
        ∇
        f
        (
        
          x
        
        +
        r
        
          v
        
        )
        −
        ∇
        f
        (
        
          x
        
        )
        +
        
          
            O
          
        
        (
        
          r
          
            2
          
        
        )
        ,
      
    
    {\displaystyle \mathbf {H} (\mathbf {x} )\Delta \mathbf {x} =\mathbf {H} (\mathbf {x} )r\mathbf {v} =r\mathbf {H} (\mathbf {x} )\mathbf {v} =\nabla f(\mathbf {x} +r\mathbf {v} )-\nabla f(\mathbf {x} )+{\mathcal {O}}(r^{2}),}
  i.e.,

  
    
      
        
          H
        
        (
        
          x
        
        )
        
          v
        
        =
        
          
            1
            r
          
        
        
          
            [
          
        
        ∇
        f
        (
        
          x
        
        +
        r
        
          v
        
        )
        −
        ∇
        f
        (
        
          x
        
        )
        
          
            ]
          
        
        +
        
          
            O
          
        
        (
        r
        )
      
    
    {\displaystyle \mathbf {H} (\mathbf {x} )\mathbf {v} ={\frac {1}{r}}{\Bigl [}\nabla f(\mathbf {x} +r\mathbf {v} )-\nabla f(\mathbf {x} ){\Bigr ]}+{\mathcal {O}}(r)}
  so if the gradient is already computed, the approximate Hessian can be computed by a linear (in the size of the gradient) number of scalar operations. (While simple to program, this approximation scheme is not numerically stable since r has to be made small to prevent error due to the 
  
    
      
        
          
            O
          
        
        (
        r
        )
      
    
    {\displaystyle {\mathcal {O}}(r)}
   term, but decreasing it loses precision in the first term.)


=== Other applications ===
The Hessian matrix is commonly used for expressing image processing operators in image processing and computer vision (see the Laplacian of Gaussian (LoG) blob detector, the determinant of Hessian (DoH) blob detector and scale space).


== Generalizations ==


=== Bordered Hessian ===
A bordered Hessian is used for the second-derivative test in certain constrained optimization problems. Given the function f considered previously, but adding a constraint function g such that g(x) = c, the bordered Hessian is the Hessian of the Lagrange function 
  
    
      
        Λ
        (
        
          x
        
        ,
        λ
        )
        =
        f
        (
        
          x
        
        )
        +
        λ
        [
        g
        (
        
          x
        
        )
        −
        c
        ]
      
    
    {\displaystyle \Lambda (\mathbf {x} ,\lambda )=f(\mathbf {x} )+\lambda [g(\mathbf {x} )-c]}
  :

  
    
      
        
          H
        
        (
        Λ
        )
        =
        
          
            [
            
              
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          Λ
                        
                        
                          ∂
                          
                            λ
                            
                              2
                            
                          
                        
                      
                    
                  
                
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          Λ
                        
                        
                          ∂
                          λ
                          ∂
                          
                            x
                          
                        
                      
                    
                  
                
              
              
                
                  
                    
                      (
                      
                        
                          
                            
                              
                                ∂
                                
                                  2
                                
                              
                              Λ
                            
                            
                              ∂
                              λ
                              ∂
                              
                                x
                              
                            
                          
                        
                      
                      )
                    
                    
                      
                        T
                      
                    
                  
                
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          Λ
                        
                        
                          ∂
                          
                            
                              x
                            
                            
                              2
                            
                          
                        
                      
                    
                  
                
              
            
            ]
          
        
        =
        
          
            [
            
              
                
                  0
                
                
                  
                    
                      
                        
                          ∂
                          g
                        
                        
                          ∂
                          
                            x
                            
                              1
                            
                          
                        
                      
                    
                  
                
                
                  
                    
                      
                        
                          ∂
                          g
                        
                        
                          ∂
                          
                            x
                            
                              2
                            
                          
                        
                      
                    
                  
                
                
                  ⋯
                
                
                  
                    
                      
                        
                          ∂
                          g
                        
                        
                          ∂
                          
                            x
                            
                              n
                            
                          
                        
                      
                    
                  
                
              
              
                
                  
                    
                      
                        
                          ∂
                          g
                        
                        
                          ∂
                          
                            x
                            
                              1
                            
                          
                        
                      
                    
                  
                
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          Λ
                        
                        
                          ∂
                          
                            x
                            
                              1
                            
                            
                              2
                            
                          
                        
                      
                    
                  
                
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          Λ
                        
                        
                          ∂
                          
                            x
                            
                              1
                            
                          
                          
                          ∂
                          
                            x
                            
                              2
                            
                          
                        
                      
                    
                  
                
                
                  ⋯
                
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          Λ
                        
                        
                          ∂
                          
                            x
                            
                              1
                            
                          
                          
                          ∂
                          
                            x
                            
                              n
                            
                          
                        
                      
                    
                  
                
              
              
                
                  
                    
                      
                        
                          ∂
                          g
                        
                        
                          ∂
                          
                            x
                            
                              2
                            
                          
                        
                      
                    
                  
                
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          Λ
                        
                        
                          ∂
                          
                            x
                            
                              2
                            
                          
                          
                          ∂
                          
                            x
                            
                              1
                            
                          
                        
                      
                    
                  
                
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          Λ
                        
                        
                          ∂
                          
                            x
                            
                              2
                            
                            
                              2
                            
                          
                        
                      
                    
                  
                
                
                  ⋯
                
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          Λ
                        
                        
                          ∂
                          
                            x
                            
                              2
                            
                          
                          
                          ∂
                          
                            x
                            
                              n
                            
                          
                        
                      
                    
                  
                
              
              
                
                  ⋮
                
                
                  ⋮
                
                
                  ⋮
                
                
                  ⋱
                
                
                  ⋮
                
              
              
                
                  
                    
                      
                        
                          ∂
                          g
                        
                        
                          ∂
                          
                            x
                            
                              n
                            
                          
                        
                      
                    
                  
                
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          Λ
                        
                        
                          ∂
                          
                            x
                            
                              n
                            
                          
                          
                          ∂
                          
                            x
                            
                              1
                            
                          
                        
                      
                    
                  
                
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          Λ
                        
                        
                          ∂
                          
                            x
                            
                              n
                            
                          
                          
                          ∂
                          
                            x
                            
                              2
                            
                          
                        
                      
                    
                  
                
                
                  ⋯
                
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          Λ
                        
                        
                          ∂
                          
                            x
                            
                              n
                            
                            
                              2
                            
                          
                        
                      
                    
                  
                
              
            
            ]
          
        
        =
        
          
            [
            
              
                
                  0
                
                
                  
                    
                      
                        
                          ∂
                          g
                        
                        
                          ∂
                          
                            x
                          
                        
                      
                    
                  
                
              
              
                
                  
                    
                      (
                      
                        
                          
                            
                              ∂
                              g
                            
                            
                              ∂
                              
                                x
                              
                            
                          
                        
                      
                      )
                    
                    
                      
                        T
                      
                    
                  
                
                
                  
                    
                      
                        
                          
                            ∂
                            
                              2
                            
                          
                          Λ
                        
                        
                          ∂
                          
                            
                              x
                            
                            
                              2
                            
                          
                        
                      
                    
                  
                
              
            
            ]
          
        
      
    
    {\displaystyle \mathbf {H} (\Lambda )={\begin{bmatrix}{\dfrac {\partial ^{2}\Lambda }{\partial \lambda ^{2}}}&{\dfrac {\partial ^{2}\Lambda }{\partial \lambda \partial \mathbf {x} }}\\\left({\dfrac {\partial ^{2}\Lambda }{\partial \lambda \partial \mathbf {x} }}\right)^{\mathsf {T}}&{\dfrac {\partial ^{2}\Lambda }{\partial \mathbf {x} ^{2}}}\end{bmatrix}}={\begin{bmatrix}0&{\dfrac {\partial g}{\partial x_{1}}}&{\dfrac {\partial g}{\partial x_{2}}}&\cdots &{\dfrac {\partial g}{\partial x_{n}}}\\[2.2ex]{\dfrac {\partial g}{\partial x_{1}}}&{\dfrac {\partial ^{2}\Lambda }{\partial x_{1}^{2}}}&{\dfrac {\partial ^{2}\Lambda }{\partial x_{1}\,\partial x_{2}}}&\cdots &{\dfrac {\partial ^{2}\Lambda }{\partial x_{1}\,\partial x_{n}}}\\[2.2ex]{\dfrac {\partial g}{\partial x_{2}}}&{\dfrac {\partial ^{2}\Lambda }{\partial x_{2}\,\partial x_{1}}}&{\dfrac {\partial ^{2}\Lambda }{\partial x_{2}^{2}}}&\cdots &{\dfrac {\partial ^{2}\Lambda }{\partial x_{2}\,\partial x_{n}}}\\[2.2ex]\vdots &\vdots &\vdots &\ddots &\vdots \\[2.2ex]{\dfrac {\partial g}{\partial x_{n}}}&{\dfrac {\partial ^{2}\Lambda }{\partial x_{n}\,\partial x_{1}}}&{\dfrac {\partial ^{2}\Lambda }{\partial x_{n}\,\partial x_{2}}}&\cdots &{\dfrac {\partial ^{2}\Lambda }{\partial x_{n}^{2}}}\end{bmatrix}}={\begin{bmatrix}0&{\dfrac {\partial g}{\partial \mathbf {x} }}\\\left({\dfrac {\partial g}{\partial \mathbf {x} }}\right)^{\mathsf {T}}&{\dfrac {\partial ^{2}\Lambda }{\partial \mathbf {x} ^{2}}}\end{bmatrix}}}
  If there are, say, m constraints then the zero in the upper-left corner is an m × m block of zeroes, and there are m border rows at the top and m border columns at the left.
The above rules stating that extrema are characterized (among critical points with a non-singular Hessian) by a positive-definite or negative-definite Hessian cannot apply here since a bordered Hessian can neither be negative-definite nor positive-definite, as 
  
    
      
        
          
            z
          
          
            
              T
            
          
        
        
          H
        
        
          z
        
        =
        0
      
    
    {\displaystyle \mathbf {z} ^{\mathsf {T}}\mathbf {H} \mathbf {z} =0}
   if 
  
    
      
        
          z
        
      
    
    {\displaystyle \mathbf {z} }
   is any vector whose sole non-zero entry is its first.
The second derivative test consists here of sign restrictions of the determinants of a certain set of n – m submatrices of the bordered Hessian. Intuitively, one can think of the m constraints as reducing the problem to one with n – m free variables. (For example, the maximization of f(x1,x2,x3) subject to the constraint x1+x2+x3 = 1 can be reduced to the maximization of f(x1,x2,1–x1–x2) without constraint.)
Specifically, sign conditions are imposed on the sequence of leading principal minors (determinants of upper-left-justified sub-matrices) of the bordered Hessian, for which the first 2m leading principal minors are neglected, the smallest minor consisting of the truncated first 2m+1 rows and columns, the next consisting of the truncated first 2m+2 rows and columns, and so on, with the last being the entire bordered Hessian; if 2m+1 is larger than n+m, then the smallest leading principal minor is the Hessian itself. There are thus n–m minors to consider, each evaluated at the specific point being considered as a candidate maximum or minimum. A sufficient condition for a local maximum is that these minors alternate in sign with the smallest one having the sign of (–1)m+1.  A sufficient condition for a local minimum is that all of these minors have the sign of (–1)m. (In the unconstrained case of m=0 these conditions coincide with the conditions for the unbordered Hessian to be negative definite or positive definite respectively).


=== Vector-valued functions ===
If f is instead a vector field f : ℝn → ℝm, i.e.

  
    
      
        
          f
        
        (
        
          x
        
        )
        =
        (
        
          f
          
            1
          
        
        (
        
          x
        
        )
        ,
        
          f
          
            2
          
        
        (
        
          x
        
        )
        ,
        …
        ,
        
          f
          
            m
          
        
        (
        
          x
        
        )
        )
        ,
      
    
    {\displaystyle \mathbf {f} (\mathbf {x} )=(f_{1}(\mathbf {x} ),f_{2}(\mathbf {x} ),\dots ,f_{m}(\mathbf {x} )),}
  then the collection of second partial derivatives is not a n×n matrix, but rather a third order tensor. This can be thought of as an array of m Hessian matrices, one for each component of f:

  
    
      
        
          H
        
        (
        
          f
        
        )
        =
        (
        
          H
        
        (
        
          f
          
            1
          
        
        )
        ,
        
          H
        
        (
        
          f
          
            2
          
        
        )
        ,
        …
        ,
        
          H
        
        (
        
          f
          
            m
          
        
        )
        )
      
    
    {\displaystyle \mathbf {H} (\mathbf {f} )=(\mathbf {H} (f_{1}),\mathbf {H} (f_{2}),\dots ,\mathbf {H} (f_{m}))}
  This tensor degenerates to the usual Hessian matrix when m = 1.


=== Generalization to the complex case ===
In the context of several complex variables, the Hessian may be generalized.  Suppose 
  
    
      
        f
        :
        
          
            C
          
          
            n
          
        
        ⟶
        
          C
        
      
    
    {\displaystyle f\colon \mathbb {C} ^{n}\longrightarrow \mathbb {C} }
  , and we write 
  
    
      
        f
        
          (
          
            
              z
              
                1
              
            
            ,
            …
            ,
            
              z
              
                n
              
            
          
          )
        
      
    
    {\displaystyle f\left(z_{1},\ldots ,z_{n}\right)}
  .  Then one may generalize the Hessian to 
  
    
      
        
          
            
              
                ∂
                
                  2
                
              
              f
            
            
              ∂
              
                z
                
                  i
                
              
              ∂
              
                
                  
                    z
                    
                      j
                    
                  
                  ¯
                
              
            
          
        
      
    
    {\displaystyle {\frac {\partial ^{2}f}{\partial z_{i}\partial {\overline {z_{j}}}}}}
  .  Note that if 
  
    
      
        f
      
    
    {\displaystyle f}
   satisfies the n-dimensional Cauchy–Riemann conditions, then the complex Hessian matrix is identically zero.


=== Generalizations to Riemannian manifolds ===
Let 
  
    
      
        (
        M
        ,
        g
        )
      
    
    {\displaystyle (M,g)}
   be a Riemannian manifold and 
  
    
      
        ∇
      
    
    {\displaystyle \nabla }
   its Levi-Civita connection. Let 
  
    
      
        f
        :
        M
        →
        
          R
        
      
    
    {\displaystyle f:M\to \mathbb {R} }
   be a smooth function. We may define the Hessian tensor

  
    
      
        
          
            
              Hess
            
          
          (
          f
          )
          ∈
          Γ
          (
          
            T
            
              ∗
            
          
          M
          ⊗
          
            T
            
              ∗
            
          
          M
          )
        
      
    
    {\displaystyle \displaystyle {\mbox{Hess}}(f)\in \Gamma (T^{*}M\otimes T^{*}M)}
   by 
  
    
      
        
          
            Hess
          
        
        (
        f
        )
        :=
        ∇
        ∇
        f
        =
        ∇
        d
        f
      
    
    {\displaystyle {\mbox{Hess}}(f):=\nabla \nabla f=\nabla df}
  ,where we have taken advantage of the first covariant derivative of a function being the same as its ordinary derivative. Choosing local coordinates 
  
    
      
        {
        
          x
          
            i
          
        
        }
      
    
    {\displaystyle \{x^{i}\}}
   we obtain the local expression for the Hessian as

  
    
      
        
          
            Hess
          
        
        (
        f
        )
        =
        
          ∇
          
            i
          
        
        
        
          ∂
          
            j
          
        
        f
         
        d
        
          x
          
            i
          
        
        
        ⊗
        
        d
        
          x
          
            j
          
        
        =
        
          (
          
            
              
                
                  
                    ∂
                    
                      2
                    
                  
                  f
                
                
                  ∂
                  
                    x
                    
                      i
                    
                  
                  ∂
                  
                    x
                    
                      j
                    
                  
                
              
            
            −
            
              Γ
              
                i
                j
              
              
                k
              
            
            
              
                
                  ∂
                  f
                
                
                  ∂
                  
                    x
                    
                      k
                    
                  
                
              
            
          
          )
        
        d
        
          x
          
            i
          
        
        ⊗
        d
        
          x
          
            j
          
        
      
    
    {\displaystyle {\mbox{Hess}}(f)=\nabla _{i}\,\partial _{j}f\ dx^{i}\!\otimes \!dx^{j}=\left({\frac {\partial ^{2}f}{\partial x^{i}\partial x^{j}}}-\Gamma _{ij}^{k}{\frac {\partial f}{\partial x^{k}}}\right)dx^{i}\otimes dx^{j}}
  where 
  
    
      
        
          Γ
          
            i
            j
          
          
            k
          
        
      
    
    {\displaystyle \Gamma _{ij}^{k}}
   are the Christoffel symbols of the connection. Other equivalent forms for the Hessian are given by

  
    
      
        
          
            Hess
          
        
        (
        f
        )
        (
        X
        ,
        Y
        )
        =
        ⟨
        
          ∇
          
            X
          
        
        
          
            grad
          
        
        f
        ,
        Y
        ⟩
      
    
    {\displaystyle {\mbox{Hess}}(f)(X,Y)=\langle \nabla _{X}{\mbox{grad}}f,Y\rangle }
   and 
  
    
      
        
          
            Hess
          
        
        (
        f
        )
        (
        X
        ,
        Y
        )
        =
        X
        (
        Y
        f
        )
        −
        d
        f
        (
        
          ∇
          
            X
          
        
        Y
        )
      
    
    {\displaystyle {\mbox{Hess}}(f)(X,Y)=X(Yf)-df(\nabla _{X}Y)}
  .


== See also ==
The determinant of the Hessian matrix is a covariant; see Invariant of a binary form
Polarization identity, useful for rapid calculations involving Hessians.
Jacobian matrix
Hessian equations


== Notes ==


== Further reading ==
Lewis, David W. (1991). Matrix Theory. Singapore: World Scientific. ISBN 978-981-02-0689-5.
Magnus, Jan R.; Neudecker, Heinz (1999). "The Second Differential". Matrix Differential Calculus : With Applications in Statistics and Econometrics (Revised ed.). New York: Wiley. pp. 99–115. ISBN 0-471-98633-X.


== External links ==
Hazewinkel, Michiel, ed. (2001) [1994], "Hessian of a function", Encyclopedia of Mathematics, Springer Science+Business Media B.V. / Kluwer Academic Publishers, ISBN 978-1-55608-010-4
Weisstein, Eric W. "Hessian". MathWorld.