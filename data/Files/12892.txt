Title: Multivariate t-distribution
Aspects: {'T distribution'}

In statistics, the multivariate t-distribution (or multivariate Student distribution) is a multivariate probability distribution. It is a generalization to random vectors of the Student's t-distribution, which is a distribution applicable to univariate random variables. While the case of a random matrix could be treated within this structure, the matrix t-distribution is distinct and makes particular use of the matrix structure.


== Definition ==
One common method of construction of a multivariate t-distribution, for the case of 
  
    
      
        p
      
    
    {\displaystyle p}
   dimensions, is based on the observation that if 
  
    
      
        
          y
        
      
    
    {\displaystyle \mathbf {y} }
   and 
  
    
      
        u
      
    
    {\displaystyle u}
   are independent and distributed as 
  
    
      
        
          
            N
          
        
        (
        
          
            0
          
        
        ,
        
          Σ
        
        )
      
    
    {\displaystyle {\mathcal {N}}({\mathbf {0} },{\boldsymbol {\Sigma }})}
   and 
  
    
      
        
          χ
          
            ν
          
          
            2
          
        
      
    
    {\displaystyle \chi _{\nu }^{2}}
   (i.e. multivariate normal and chi-squared distributions) respectively, the matrix 
  
    
      
        
          Σ
        
        
      
    
    {\displaystyle \mathbf {\Sigma } \,}
   is a p × p matrix, and 
  
    
      
        
          
            y
          
        
        
          /
        
        
          
            u
            
              /
            
            ν
          
        
        =
        
          
            x
          
        
        −
        
          μ
        
      
    
    {\displaystyle {\mathbf {y} }/{\sqrt {u/\nu }}={\mathbf {x} }-{\boldsymbol {\mu }}}
  , then 
  
    
      
        
          
            x
          
        
      
    
    {\displaystyle {\mathbf {x} }}
   has the density

  
    
      
        
          
            
              Γ
              
                [
                
                  (
                  ν
                  +
                  p
                  )
                  
                    /
                  
                  2
                
                ]
              
            
            
              Γ
              (
              ν
              
                /
              
              2
              )
              
                ν
                
                  p
                  
                    /
                  
                  2
                
              
              
                π
                
                  p
                  
                    /
                  
                  2
                
              
              
                
                  |
                  
                    Σ
                  
                  |
                
                
                  1
                  
                    /
                  
                  2
                
              
            
          
        
        
          
            [
            
              1
              +
              
                
                  1
                  ν
                
              
              (
              
                
                  x
                
              
              −
              
                μ
              
              
                )
                
                  T
                
              
              
                
                  Σ
                
                
                  −
                  1
                
              
              (
              
                
                  x
                
              
              −
              
                μ
              
              )
            
            ]
          
          
            −
            (
            ν
            +
            p
            )
            
              /
            
            2
          
        
      
    
    {\displaystyle {\frac {\Gamma \left[(\nu +p)/2\right]}{\Gamma (\nu /2)\nu ^{p/2}\pi ^{p/2}\left|{\boldsymbol {\Sigma }}\right|^{1/2}}}\left[1+{\frac {1}{\nu }}({\mathbf {x} }-{\boldsymbol {\mu }})^{T}{\boldsymbol {\Sigma }}^{-1}({\mathbf {x} }-{\boldsymbol {\mu }})\right]^{-(\nu +p)/2}}
  and is said to be distributed as a multivariate t-distribution with parameters 
  
    
      
        
          Σ
        
        ,
        
          μ
        
        ,
        ν
      
    
    {\displaystyle {\boldsymbol {\Sigma }},{\boldsymbol {\mu }},\nu }
  . Note that 
  
    
      
        
          Σ
        
      
    
    {\displaystyle \mathbf {\Sigma } }
   is not the covariance matrix since the covariance is given by 
  
    
      
        ν
        
          /
        
        (
        ν
        −
        2
        )
        
          Σ
        
      
    
    {\displaystyle \nu /(\nu -2)\mathbf {\Sigma } }
   (for 
  
    
      
        ν
        >
        2
      
    
    {\displaystyle \nu >2}
  ).
In the special case 
  
    
      
        ν
        =
        1
      
    
    {\displaystyle \nu =1}
  , the distribution is a multivariate Cauchy distribution.


== Derivation ==
There are in fact many candidates for the multivariate generalization of Student's t-distribution. An extensive survey of the field has been given by Kotz and Nadarajah (2004). The essential issue is to define a probability density function of several variables that is the appropriate generalization of the formula for the univariate case. In one dimension (
  
    
      
        p
        =
        1
      
    
    {\displaystyle p=1}
  ), with 
  
    
      
        t
        =
        x
        −
        μ
      
    
    {\displaystyle t=x-\mu }
   and 
  
    
      
        Σ
        =
        1
      
    
    {\displaystyle \Sigma =1}
  , we have the probability density function

  
    
      
        f
        (
        t
        )
        =
        
          
            
              Γ
              [
              (
              ν
              +
              1
              )
              
                /
              
              2
              ]
            
            
              
                
                  ν
                  π
                  
                
              
              
              Γ
              [
              ν
              
                /
              
              2
              ]
            
          
        
        (
        1
        +
        
          t
          
            2
          
        
        
          /
        
        ν
        
          )
          
            −
            (
            ν
            +
            1
            )
            
              /
            
            2
          
        
      
    
    {\displaystyle f(t)={\frac {\Gamma [(\nu +1)/2]}{{\sqrt {\nu \pi \,}}\,\Gamma [\nu /2]}}(1+t^{2}/\nu )^{-(\nu +1)/2}}
  and one approach is to write down a corresponding function of several variables. This is the basic idea of elliptical distribution theory, where one writes down a corresponding function of 
  
    
      
        p
      
    
    {\displaystyle p}
   variables 
  
    
      
        
          t
          
            i
          
        
      
    
    {\displaystyle t_{i}}
   that replaces 
  
    
      
        
          t
          
            2
          
        
      
    
    {\displaystyle t^{2}}
   by a quadratic function of all the 
  
    
      
        
          t
          
            i
          
        
      
    
    {\displaystyle t_{i}}
  . It is clear that this only makes sense when all the marginal distributions have the same degrees of freedom 
  
    
      
        ν
      
    
    {\displaystyle \nu }
  . With 
  
    
      
        
          A
        
        =
        
          
            Σ
          
          
            −
            1
          
        
      
    
    {\displaystyle \mathbf {A} ={\boldsymbol {\Sigma }}^{-1}}
  , one has a simple choice of multivariate density function

  
    
      
        f
        (
        
          t
        
        )
        =
        
          
            
              Γ
              (
              (
              ν
              +
              p
              )
              
                /
              
              2
              )
              
                
                  |
                  
                    A
                  
                  |
                
                
                  1
                  
                    /
                  
                  2
                
              
            
            
              
                
                  
                    ν
                    
                      p
                    
                  
                  
                    π
                    
                      p
                    
                  
                  
                
              
              
              Γ
              (
              ν
              
                /
              
              2
              )
            
          
        
        
          
            (
            
              1
              +
              
                ∑
                
                  i
                  ,
                  j
                  =
                  1
                
                
                  p
                  ,
                  p
                
              
              
                A
                
                  i
                  j
                
              
              
                t
                
                  i
                
              
              
                t
                
                  j
                
              
              
                /
              
              ν
            
            )
          
          
            −
            (
            ν
            +
            p
            )
            
              /
            
            2
          
        
      
    
    {\displaystyle f(\mathbf {t} )={\frac {\Gamma ((\nu +p)/2)\left|\mathbf {A} \right|^{1/2}}{{\sqrt {\nu ^{p}\pi ^{p}\,}}\,\Gamma (\nu /2)}}\left(1+\sum _{i,j=1}^{p,p}A_{ij}t_{i}t_{j}/\nu \right)^{-(\nu +p)/2}}
  which is the standard but not the only choice.
An important special case is the standard bivariate t-distribution, p = 2:

  
    
      
        f
        (
        
          t
          
            1
          
        
        ,
        
          t
          
            2
          
        
        )
        =
        
          
            
              
                |
                
                  A
                
                |
              
              
                1
                
                  /
                
                2
              
            
            
              2
              π
            
          
        
        
          
            (
            
              1
              +
              
                ∑
                
                  i
                  ,
                  j
                  =
                  1
                
                
                  2
                  ,
                  2
                
              
              
                A
                
                  i
                  j
                
              
              
                t
                
                  i
                
              
              
                t
                
                  j
                
              
              
                /
              
              ν
            
            )
          
          
            −
            (
            ν
            +
            2
            )
            
              /
            
            2
          
        
      
    
    {\displaystyle f(t_{1},t_{2})={\frac {\left|\mathbf {A} \right|^{1/2}}{2\pi }}\left(1+\sum _{i,j=1}^{2,2}A_{ij}t_{i}t_{j}/\nu \right)^{-(\nu +2)/2}}
  Note that 
  
    
      
        
          
            
              Γ
              
                (
                
                  
                    
                      ν
                      +
                      2
                    
                    2
                  
                
                )
              
            
            
              π
               
              ν
              Γ
              
                (
                
                  
                    ν
                    2
                  
                
                )
              
            
          
        
        =
        
          
            1
            
              2
              π
            
          
        
      
    
    {\displaystyle {\frac {\Gamma \left({\frac {\nu +2}{2}}\right)}{\pi \ \nu \Gamma \left({\frac {\nu }{2}}\right)}}={\frac {1}{2\pi }}}
  .
Now, if 
  
    
      
        
          A
        
      
    
    {\displaystyle \mathbf {A} }
   is the identity matrix, the density is

  
    
      
        f
        (
        
          t
          
            1
          
        
        ,
        
          t
          
            2
          
        
        )
        =
        
          
            1
            
              2
              π
            
          
        
        
          
            (
            
              1
              +
              (
              
                t
                
                  1
                
                
                  2
                
              
              +
              
                t
                
                  2
                
                
                  2
                
              
              )
              
                /
              
              ν
            
            )
          
          
            −
            (
            ν
            +
            2
            )
            
              /
            
            2
          
        
        .
      
    
    {\displaystyle f(t_{1},t_{2})={\frac {1}{2\pi }}\left(1+(t_{1}^{2}+t_{2}^{2})/\nu \right)^{-(\nu +2)/2}.}
  The difficulty with the standard representation is revealed by this formula, which does not factorize into the product of the marginal one-dimensional distributions. When 
  
    
      
        Σ
      
    
    {\displaystyle \Sigma }
   is diagonal the standard representation can be shown to have zero correlation but the marginal distributions do not agree with statistical independence.


=== Cumulative distribution function ===
The definition of the cumulative distribution function (cdf) in one dimension can be extended to multiple dimensions by defining the following probability (here 
  
    
      
        
          x
        
      
    
    {\displaystyle \mathbf {x} }
   is a real vector):

  
    
      
        F
        (
        
          x
        
        )
        =
        
          P
        
        (
        
          X
        
        ≤
        
          x
        
        )
        ,
        
        
          
            where
          
        
        
        
        
          X
        
        ∼
        
          t
          
            ν
          
        
        (
        
          μ
        
        ,
        
          Σ
        
        )
        .
      
    
    {\displaystyle F(\mathbf {x} )=\mathbb {P} (\mathbf {X} \leq \mathbf {x} ),\quad {\textrm {where}}\;\;\mathbf {X} \sim t_{\nu }({\boldsymbol {\mu }},{\boldsymbol {\Sigma }}).}
  There is no simple formula for 
  
    
      
        F
        (
        
          x
        
        )
      
    
    {\displaystyle F(\mathbf {x} )}
  , but it can be approximated numerically via Monte Carlo integration.


== Further theory ==
Many such distributions may be constructed by considering the quotients of normal random variables with the square root of a sample from a chi-squared distribution. These are surveyed in the references and links below.


== Copulas based on the multivariate t ==
The use of such distributions is enjoying renewed interest due to applications in mathematical finance, especially through the use of the Student's t copula.


== Related concepts ==
In univariate statistics, the Student's t-test makes use of Student's t-distribution. Hotelling's T-squared distribution is a distribution that arises in multivariate statistics. The matrix t-distribution is a distribution for random variables arranged in a matrix structure.


== See also ==
Multivariate normal distribution, which is a special case of the multivariate Student's t-distribution when 
  
    
      
        ν
        ↑
        ∞
      
    
    {\displaystyle \nu \uparrow \infty }
  .
Chi distribution, the pdf of the scaling factor in the construction the Student's t-distribution and also the 2-norm (or Euclidean norm) of a multivariate normally distributed vector (centered at zero).
Mahalanobis distance


== References ==


== Literature ==


== External links ==
Copula Methods vs Canonical Multivariate Distributions: the multivariate Student T distribution with general degrees of freedom
Multivariate Student's t-distribution