Moving-average model

In the statistical analysis of time series, autoregressive–moving-average (ARMA) models provide a parsimonious description of a (weakly) stationary stochastic process in terms of two polynomials, one for the autoregression (AR) and the second for the moving average (MA). The general ARMA model was described in the 1951 thesis of Peter Whittle, Hypothesis testing in time series analysis, and it was popularized in the 1970 book by George E. P. Box and Gwilym Jenkins.
Given a time series of data Xt , the ARMA model is a tool for understanding and, perhaps, predicting future values in this series. The AR part involves regressing the variable on its own lagged (i.e., past) values. The MA part involves modeling the error term as a linear combination of error terms occurring contemporaneously and at various times in the past.
The model is usually referred to as the ARMA(p,q) model where p is the order of the AR part and q is the order of the MA part (as defined below).
ARMA models can be estimated by using the Box–Jenkins method.


== Autoregressive model ==

The notation AR(p) refers to the autoregressive model of order p. The AR(p) model is written

  
    
      
        
          X
          
            t
          
        
        =
        c
        +
        
          ∑
          
            i
            =
            1
          
          
            p
          
        
        
          φ
          
            i
          
        
        
          X
          
            t
            −
            i
          
        
        +
        
          ε
          
            t
          
        
        .
        
      
    
    {\displaystyle X_{t}=c+\sum _{i=1}^{p}\varphi _{i}X_{t-i}+\varepsilon _{t}.\,}
  where 
  
    
      
        
          φ
          
            1
          
        
        ,
        …
        ,
        
          φ
          
            p
          
        
      
    
    {\displaystyle \varphi _{1},\ldots ,\varphi _{p}}
   are parameters, 
  
    
      
        c
      
    
    {\displaystyle c}
   is a constant, and the random variable 
  
    
      
        
          ε
          
            t
          
        
      
    
    {\displaystyle \varepsilon _{t}}
   is white noise.
Some constraints are necessary on the values of the parameters so that the model remains stationary.  For example, processes in the AR(1) model with 
  
    
      
        
          |
        
        
          φ
          
            1
          
        
        
          |
        
        ≥
        1
      
    
    {\displaystyle |\varphi _{1}|\geq 1}
   are not stationary.


== Moving-average model ==

The notation MA(q) refers to the moving average model of order q:

  
    
      
        
          X
          
            t
          
        
        =
        μ
        +
        
          ε
          
            t
          
        
        +
        
          ∑
          
            i
            =
            1
          
          
            q
          
        
        
          θ
          
            i
          
        
        
          ε
          
            t
            −
            i
          
        
        
      
    
    {\displaystyle X_{t}=\mu +\varepsilon _{t}+\sum _{i=1}^{q}\theta _{i}\varepsilon _{t-i}\,}
  where the θ1, ..., θq are the parameters of the model, μ is the expectation of 
  
    
      
        
          X
          
            t
          
        
      
    
    {\displaystyle X_{t}}
   (often assumed to equal 0), and the 
  
    
      
        
          ε
          
            t
          
        
      
    
    {\displaystyle \varepsilon _{t}}
  , 
  
    
      
        
          ε
          
            t
            −
            1
          
        
      
    
    {\displaystyle \varepsilon _{t-1}}
  ,... are again, white noise error terms.


== ARMA model ==
The notation ARMA(p, q) refers to the model with p autoregressive terms and q moving-average terms. This model contains the AR(p) and MA(q) models,

  
    
      
        
          X
          
            t
          
        
        =
        c
        +
        
          ε
          
            t
          
        
        +
        
          ∑
          
            i
            =
            1
          
          
            p
          
        
        
          φ
          
            i
          
        
        
          X
          
            t
            −
            i
          
        
        +
        
          ∑
          
            i
            =
            1
          
          
            q
          
        
        
          θ
          
            i
          
        
        
          ε
          
            t
            −
            i
          
        
        .
        
      
    
    {\displaystyle X_{t}=c+\varepsilon _{t}+\sum _{i=1}^{p}\varphi _{i}X_{t-i}+\sum _{i=1}^{q}\theta _{i}\varepsilon _{t-i}.\,}
  The general ARMA model was described in the 1951 thesis of Peter Whittle, who used mathematical analysis (Laurent series and Fourier analysis) and statistical inference. ARMA models were popularized by a 1970 book by George E. P. Box and Jenkins, who expounded an iterative (Box–Jenkins) method for choosing and estimating them. This method was useful for low-order polynomials (of degree three or less).


== Note about the error terms ==
The error terms 
  
    
      
        
          ε
          
            t
          
        
      
    
    {\displaystyle \varepsilon _{t}}
   are generally assumed to be independent identically distributed random variables (i.i.d.)  sampled from a normal distribution with zero mean: 
  
    
      
        
          ε
          
            t
          
        
      
    
    {\displaystyle \varepsilon _{t}}
    ~ N(0,σ2) where σ2 is
the variance.  These assumptions may be weakened but doing so will change the properties of the model.  In particular, a change to the i.i.d. assumption would make a rather fundamental difference.


== Specification in terms of lag operator ==
In some texts the models will be specified in terms of the lag operator L.
In these terms then the AR(p) model is given by

  
    
      
        
          ε
          
            t
          
        
        =
        
          (
          
            1
            −
            
              ∑
              
                i
                =
                1
              
              
                p
              
            
            
              φ
              
                i
              
            
            
              L
              
                i
              
            
          
          )
        
        
          X
          
            t
          
        
        =
        φ
        (
        L
        )
        
          X
          
            t
          
        
        
      
    
    {\displaystyle \varepsilon _{t}=\left(1-\sum _{i=1}^{p}\varphi _{i}L^{i}\right)X_{t}=\varphi (L)X_{t}\,}
  where 
  
    
      
        φ
      
    
    {\displaystyle \varphi }
   represents the polynomial

  
    
      
        φ
        (
        L
        )
        =
        1
        −
        
          ∑
          
            i
            =
            1
          
          
            p
          
        
        
          φ
          
            i
          
        
        
          L
          
            i
          
        
        .
        
      
    
    {\displaystyle \varphi (L)=1-\sum _{i=1}^{p}\varphi _{i}L^{i}.\,}
  The MA(q) model is given by

  
    
      
        
          X
          
            t
          
        
        =
        
          (
          
            1
            +
            
              ∑
              
                i
                =
                1
              
              
                q
              
            
            
              θ
              
                i
              
            
            
              L
              
                i
              
            
          
          )
        
        
          ε
          
            t
          
        
        =
        θ
        (
        L
        )
        
          ε
          
            t
          
        
        ,
        
      
    
    {\displaystyle X_{t}=\left(1+\sum _{i=1}^{q}\theta _{i}L^{i}\right)\varepsilon _{t}=\theta (L)\varepsilon _{t},\,}
  where θ represents the polynomial

  
    
      
        θ
        (
        L
        )
        =
        1
        +
        
          ∑
          
            i
            =
            1
          
          
            q
          
        
        
          θ
          
            i
          
        
        
          L
          
            i
          
        
        .
        
      
    
    {\displaystyle \theta (L)=1+\sum _{i=1}^{q}\theta _{i}L^{i}.\,}
  Finally, the combined ARMA(p, q) model is given by

  
    
      
        
          (
          
            1
            −
            
              ∑
              
                i
                =
                1
              
              
                p
              
            
            
              φ
              
                i
              
            
            
              L
              
                i
              
            
          
          )
        
        
          X
          
            t
          
        
        =
        
          (
          
            1
            +
            
              ∑
              
                i
                =
                1
              
              
                q
              
            
            
              θ
              
                i
              
            
            
              L
              
                i
              
            
          
          )
        
        
          ε
          
            t
          
        
        
        ,
      
    
    {\displaystyle \left(1-\sum _{i=1}^{p}\varphi _{i}L^{i}\right)X_{t}=\left(1+\sum _{i=1}^{q}\theta _{i}L^{i}\right)\varepsilon _{t}\,,}
  or more concisely,

  
    
      
        φ
        (
        L
        )
        
          X
          
            t
          
        
        =
        θ
        (
        L
        )
        
          ε
          
            t
          
        
        
      
    
    {\displaystyle \varphi (L)X_{t}=\theta (L)\varepsilon _{t}\,}
  or

  
    
      
        
          
            
              φ
              (
              L
              )
            
            
              θ
              (
              L
              )
            
          
        
        
          X
          
            t
          
        
        =
        
          ε
          
            t
          
        
        
        .
      
    
    {\displaystyle {\frac {\varphi (L)}{\theta (L)}}X_{t}=\varepsilon _{t}\,.}
  


=== Alternative notation ===
Some authors, including Box, Jenkins & Reinsel use a different convention for the autoregression coefficients. This allows all the polynomials involving the lag operator to appear in a similar form throughout. Thus the ARMA model would be written as

  
    
      
        
          (
          
            1
            −
            
              ∑
              
                i
                =
                1
              
              
                p
              
            
            
              ϕ
              
                i
              
            
            
              L
              
                i
              
            
          
          )
        
        
          X
          
            t
          
        
        =
        
          (
          
            1
            +
            
              ∑
              
                i
                =
                1
              
              
                q
              
            
            
              θ
              
                i
              
            
            
              L
              
                i
              
            
          
          )
        
        
          ε
          
            t
          
        
        
        .
      
    
    {\displaystyle \left(1-\sum _{i=1}^{p}\phi _{i}L^{i}\right)X_{t}=\left(1+\sum _{i=1}^{q}\theta _{i}L^{i}\right)\varepsilon _{t}\,.}
  Moreover, if we set  
  
    
      
        
          ϕ
          
            0
          
        
        =
        −
        1
      
    
    {\displaystyle \phi _{0}=-1}
   and 
  
    
      
        
          θ
          
            0
          
        
        =
        1
      
    
    {\displaystyle \theta _{0}=1}
  , then we get an even more elegant formulation:

  
    
      
        −
        
          ∑
          
            i
            =
            0
          
          
            p
          
        
        
          ϕ
          
            i
          
        
        
          L
          
            i
          
        
        
        
          X
          
            t
          
        
        =
        
          ∑
          
            i
            =
            0
          
          
            q
          
        
        
          θ
          
            i
          
        
        
          L
          
            i
          
        
        
        
          ε
          
            t
          
        
        
        .
      
    
    {\displaystyle -\sum _{i=0}^{p}\phi _{i}L^{i}\;X_{t}=\sum _{i=0}^{q}\theta _{i}L^{i}\;\varepsilon _{t}\,.}
  


== Fitting models ==


=== Choosing p and q ===
Finding appropriate values of p and q in the ARMA(p,q) model can be facilitated by plotting the partial autocorrelation functions for an estimate of p, and likewise using the autocorrelation functions for an estimate of q. Further information can be gleaned by considering the same functions for the residuals of a model fitted with an initial selection of p and q.
Brockwell & Davis recommend using Akaike information criterion (AIC) for finding p and q.


=== Estimating coefficients ===
ARMA models in general can be, after choosing p and q, fitted by least squares regression to find the values of the parameters which minimize the error term.  It is generally considered good practice to find the smallest values of p and q which provide an acceptable fit to the data.  For a pure AR model the Yule-Walker equations may be used to provide a fit.


=== Implementations in statistics packages ===
In R, the arima function (in standard package stats) is documented in ARIMA Modelling of Time Series. Extension packages contain related and extended functionality, e.g., the tseries package includes an arma function, documented in "Fit ARMA Models to Time Series"; the fracdiff package contains fracdiff() for fractionally integrated ARMA processes, etc.  The CRAN task view on Time Series contains links to most of these.
Mathematica has a complete library of time series functions including ARMA.
MATLAB includes functions such as arma and ar to estimate AR, ARX (autoregressive exogenous), and ARMAX models.  See  System Identification Toolbox and Econometrics Toolbox for more information.
 Julia has some community driven packages that implement fitting with an ARMA model such as arma.jl.
Statsmodels Python module includes many models and functions for time series analysis, including ARMA. Formerly part of Scikit-learn it is now stand-alone and integrates well with Pandas. See here for more details.
PyFlux has a Python-based implementation of ARIMAX models, including Bayesian ARIMAX models.
IMSL Numerical Libraries are libraries of numerical analysis functionality including ARMA and ARIMA procedures implemented in standard programming languages like C, Java, C# .NET, and Fortran.
gretl can also estimate ARMA model, see here where it's mentioned.
GNU Octave can estimate AR models using functions from the extra package octave-forge.
Stata includes the function arima which can estimate ARMA and ARIMA models. See here for more details.
SuanShu is a Java library of numerical methods, including comprehensive statistics packages, in which univariate/multivariate ARMA, ARIMA, ARMAX, etc. models are implemented in an object-oriented approach. These implementations are documented in "SuanShu, a Java numerical and statistical library".
SAS has an econometric package, ETS, that estimates ARIMA models. See here for more details.


== Applications ==
ARMA is appropriate when a system is a function of a series of unobserved shocks (the MA or moving average part) as well as its own behavior.  For example, stock prices may be shocked by fundamental information as well as exhibiting technical trending and mean-reversion effects due to market participants.


== Generalizations ==
The dependence of Xt on past values and the error terms εt is assumed to be linear unless specified otherwise. If the dependence is nonlinear, the model is specifically called a nonlinear moving average (NMA), nonlinear autoregressive (NAR), or nonlinear autoregressive–moving-average (NARMA) model.
Autoregressive–moving-average models can be generalized in other ways. See also autoregressive conditional heteroskedasticity (ARCH) models and autoregressive integrated moving average (ARIMA) models.  If multiple time series are to be fitted then a vector ARIMA (or VARIMA) model may be fitted.  If the time-series in question exhibits long memory then fractional ARIMA (FARIMA, sometimes called ARFIMA) modelling may be appropriate: see Autoregressive fractionally integrated moving average.  If the data is thought to contain seasonal effects, it may be modeled by a SARIMA (seasonal ARIMA) or a periodic ARMA model.
Another generalization is the multiscale autoregressive (MAR) model.  A MAR model is indexed by the nodes of a tree, whereas a standard (discrete time) autoregressive model is indexed by integers.
Note that the ARMA model is a univariate model. Extensions for the multivariate case are the vector autoregression (VAR) and Vector Autoregression Moving-Average (VARMA).


=== Autoregressive–moving-average model with exogenous inputs model (ARMAX model) ===
The notation ARMAX(p, q, b) refers to the model with p autoregressive terms, q moving average terms and b exogenous inputs terms. This model contains the AR(p) and MA(q) models and a linear combination of the last b terms of a known and external time series 
  
    
      
        
          d
          
            t
          
        
      
    
    {\displaystyle d_{t}}
  . It is given by:

  
    
      
        
          X
          
            t
          
        
        =
        
          ε
          
            t
          
        
        +
        
          ∑
          
            i
            =
            1
          
          
            p
          
        
        
          φ
          
            i
          
        
        
          X
          
            t
            −
            i
          
        
        +
        
          ∑
          
            i
            =
            1
          
          
            q
          
        
        
          θ
          
            i
          
        
        
          ε
          
            t
            −
            i
          
        
        +
        
          ∑
          
            i
            =
            1
          
          
            b
          
        
        
          η
          
            i
          
        
        
          d
          
            t
            −
            i
          
        
        .
        
      
    
    {\displaystyle X_{t}=\varepsilon _{t}+\sum _{i=1}^{p}\varphi _{i}X_{t-i}+\sum _{i=1}^{q}\theta _{i}\varepsilon _{t-i}+\sum _{i=1}^{b}\eta _{i}d_{t-i}.\,}
  where 
  
    
      
        
          η
          
            1
          
        
        ,
        …
        ,
        
          η
          
            b
          
        
      
    
    {\displaystyle \eta _{1},\ldots ,\eta _{b}}
   are the parameters of the exogenous input 
  
    
      
        
          d
          
            t
          
        
      
    
    {\displaystyle d_{t}}
  .
Some nonlinear variants of models with exogenous variables have been defined: see for example Nonlinear autoregressive exogenous model.
Statistical packages implement the ARMAX model through the use of "exogenous" or "independent" variables. Care must be taken when interpreting the output of those packages, because the estimated parameters usually (for example, in R and gretl) refer to the regression:

  
    
      
        
          X
          
            t
          
        
        −
        
          m
          
            t
          
        
        =
        
          ε
          
            t
          
        
        +
        
          ∑
          
            i
            =
            1
          
          
            p
          
        
        
          φ
          
            i
          
        
        (
        
          X
          
            t
            −
            i
          
        
        −
        
          m
          
            t
            −
            i
          
        
        )
        +
        
          ∑
          
            i
            =
            1
          
          
            q
          
        
        
          θ
          
            i
          
        
        
          ε
          
            t
            −
            i
          
        
        .
        
      
    
    {\displaystyle X_{t}-m_{t}=\varepsilon _{t}+\sum _{i=1}^{p}\varphi _{i}(X_{t-i}-m_{t-i})+\sum _{i=1}^{q}\theta _{i}\varepsilon _{t-i}.\,}
  where mt incorporates all exogenous (or independent) variables:

  
    
      
        
          m
          
            t
          
        
        =
        c
        +
        
          ∑
          
            i
            =
            0
          
          
            b
          
        
        
          η
          
            i
          
        
        
          d
          
            t
            −
            i
          
        
        .
        
      
    
    {\displaystyle m_{t}=c+\sum _{i=0}^{b}\eta _{i}d_{t-i}.\,}
  


== See also ==
Autoregressive integrated moving average (ARIMA)
Exponential smoothing
Linear predictive coding
Predictive analytics


== References ==


== Further reading ==
Mills, Terence C. (1990). Time Series Techniques for Economists. Cambridge University Press. ISBN 0521343399.
Percival, Donald B.; Walden, Andrew T. (1993). Spectral Analysis for Physical Applications. Cambridge University Press. ISBN 052135532X.
Francq, C.; Zakoïan, J.-M. (2005), "Recent results for linear time series models with non independent innovations",  in Duchesne, P.; Remillard, B. (eds.), Statistical Modeling and Analysis for Complex Data Problems, Springer, pp. 241–265.