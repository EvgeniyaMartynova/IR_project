M√∏ller‚ÄìPlesset perturbation theory

M√∏ller‚ÄìPlesset perturbation theory (MP) is one of several quantum chemistry post-Hartree‚ÄìFock ab initio methods in the field of computational chemistry. It improves on the Hartree‚ÄìFock method by adding electron correlation effects by means of Rayleigh‚ÄìSchr√∂dinger perturbation theory (RS-PT), usually to second (MP2), third (MP3) or fourth (MP4) order.  Its main idea was published as early as 1934 by Christian M√∏ller and Milton S. Plesset.


== Rayleigh‚ÄìSchr√∂dinger perturbation theory ==

The MP perturbation theory is a special case of RS perturbation theory. In RS theory one considers an unperturbed Hamiltonian operator 
  
    
      
        
          
            
              
                H
                ^
              
            
          
          
            0
          
        
      
    
    {\displaystyle {\hat {H}}_{0}}
  , to which a small (often external) perturbation 
  
    
      
        
          
            
              V
              ^
            
          
        
      
    
    {\displaystyle {\hat {V}}}
   is added:

  
    
      
        
          
            
              H
              ^
            
          
        
        =
        
          
            
              
                H
                ^
              
            
          
          
            0
          
        
        +
        Œª
        
          
            
              V
              ^
            
          
        
        .
      
    
    {\displaystyle {\hat {H}}={\hat {H}}_{0}+\lambda {\hat {V}}.}
  Here, Œª is an arbitrary real parameter that controls the size of the perturbation.  In MP theory the zeroth-order wave function is an exact eigenfunction of the Fock operator, which thus serves as the unperturbed operator. The perturbation is the correlation potential.
In RS-PT the perturbed wave function and perturbed energy are expressed as a power series in Œª:

  
    
      
        Œ®
        =
        
          lim
          
            m
            ‚Üí
            ‚àû
          
        
        
          ‚àë
          
            i
            =
            0
          
          
            m
          
        
        
          Œª
          
            i
          
        
        
          Œ®
          
            (
            i
            )
          
        
        ,
      
    
    {\displaystyle \Psi =\lim _{m\to \infty }\sum _{i=0}^{m}\lambda ^{i}\Psi ^{(i)},}
  

  
    
      
        E
        =
        
          lim
          
            m
            ‚Üí
            ‚àû
          
        
        
          ‚àë
          
            i
            =
            0
          
          
            m
          
        
        
          Œª
          
            i
          
        
        
          E
          
            (
            i
            )
          
        
        .
      
    
    {\displaystyle E=\lim _{m\to \infty }\sum _{i=0}^{m}\lambda ^{i}E^{(i)}.}
  Substitution of these series into the time-independent Schr√∂dinger equation gives a new equation as 
  
    
      
        m
        ‚Üí
        ‚àû
      
    
    {\displaystyle m\to \infty }
  :

  
    
      
        
          (
          
            
              
                
                  
                    H
                    ^
                  
                
              
              
                0
              
            
            +
            Œª
            V
          
          )
        
        
          (
          
            
              ‚àë
              
                i
                =
                0
              
              
                m
              
            
            
              Œª
              
                i
              
            
            
              Œ®
              
                (
                i
                )
              
            
          
          )
        
        =
        
          (
          
            
              ‚àë
              
                i
                =
                0
              
              
                m
              
            
            
              Œª
              
                i
              
            
            
              E
              
                (
                i
                )
              
            
          
          )
        
        
          (
          
            
              ‚àë
              
                i
                =
                0
              
              
                m
              
            
            
              Œª
              
                i
              
            
            
              Œ®
              
                (
                i
                )
              
            
          
          )
        
        .
      
    
    {\displaystyle \left({\hat {H}}_{0}+\lambda V\right)\left(\sum _{i=0}^{m}\lambda ^{i}\Psi ^{(i)}\right)=\left(\sum _{i=0}^{m}\lambda ^{i}E^{(i)}\right)\left(\sum _{i=0}^{m}\lambda ^{i}\Psi ^{(i)}\right).}
  Equating the factors of 
  
    
      
        
          Œª
          
            k
          
        
      
    
    {\displaystyle \lambda ^{k}}
   in this equation gives a kth-order perturbation equation, where k = 0, 1, 2, ..., m. See perturbation theory for more details.


== M√∏ller‚ÄìPlesset perturbation ==


=== Original formulation ===
The MP-energy corrections are obtained from Rayleigh‚ÄìSchr√∂dinger (RS) perturbation theory with the unperturbed Hamiltonian defined as the shifted Fock operator,

  
    
      
        
          
            
              
                H
                ^
              
            
          
          
            0
          
        
        ‚â°
        
          
            
              F
              ^
            
          
        
        +
        ‚ü®
        
          Œ¶
          
            0
          
        
        
          |
        
        (
        
          
            
              H
              ^
            
          
        
        ‚àí
        
          
            
              F
              ^
            
          
        
        )
        
          |
        
        
          Œ¶
          
            0
          
        
        ‚ü©
      
    
    {\displaystyle {\hat {H}}_{0}\equiv {\hat {F}}+\langle \Phi _{0}|({\hat {H}}-{\hat {F}})|\Phi _{0}\rangle }
  and the perturbation defined as the correlation potential,

  
    
      
        
          
            
              V
              ^
            
          
        
        ‚â°
        
          
            
              H
              ^
            
          
        
        ‚àí
        
          
            
              
                H
                ^
              
            
          
          
            0
          
        
        =
        
          
            
              H
              ^
            
          
        
        ‚àí
        
          (
          
            
              
                
                  F
                  ^
                
              
            
            +
            ‚ü®
            
              Œ¶
              
                0
              
            
            
              |
            
            (
            
              
                
                  H
                  ^
                
              
            
            ‚àí
            
              
                
                  F
                  ^
                
              
            
            )
            
              |
            
            
              Œ¶
              
                0
              
            
            ‚ü©
          
          )
        
        ,
      
    
    {\displaystyle {\hat {V}}\equiv {\hat {H}}-{\hat {H}}_{0}={\hat {H}}-\left({\hat {F}}+\langle \Phi _{0}|({\hat {H}}-{\hat {F}})|\Phi _{0}\rangle \right),}
  where the normalized Slater determinant Œ¶0 is the lowest eigenstate of the Fock operator:

  
    
      
        
          
            
              F
              ^
            
          
        
        
          Œ¶
          
            0
          
        
        ‚â°
        
          ‚àë
          
            k
            =
            1
          
          
            N
          
        
        
          
            
              f
              ^
            
          
        
        (
        k
        )
        
          Œ¶
          
            0
          
        
        =
        2
        
          ‚àë
          
            i
            =
            1
          
          
            N
            
              /
            
            2
          
        
        
          Œµ
          
            i
          
        
        
          Œ¶
          
            0
          
        
        .
      
    
    {\displaystyle {\hat {F}}\Phi _{0}\equiv \sum _{k=1}^{N}{\hat {f}}(k)\Phi _{0}=2\sum _{i=1}^{N/2}\varepsilon _{i}\Phi _{0}.}
  Here N is the number of electrons in the molecule under consideration (a factor of 2 in the energy arises from the fact that each orbital is occupied by a pair of electrons with opposite spin), 
  
    
      
        
          
            
              H
              ^
            
          
        
      
    
    {\displaystyle {\hat {H}}}
   is the usual electronic Hamiltonian, 
  
    
      
        
          
            
              f
              ^
            
          
        
        (
        k
        )
      
    
    {\displaystyle {\hat {f}}(k)}
   is the one-electron Fock operator, and Œµi is the orbital energy belonging to the doubly occupied spatial orbital œÜi.
Since the Slater determinant Œ¶0 is an eigenstate of 
  
    
      
        
          
            
              F
              ^
            
          
        
      
    
    {\displaystyle {\hat {F}}}
  , it follows readily that

  
    
      
        
          
            
              F
              ^
            
          
        
        
          Œ¶
          
            0
          
        
        ‚àí
        ‚ü®
        
          Œ¶
          
            0
          
        
        
          |
        
        
          
            
              F
              ^
            
          
        
        
          |
        
        
          Œ¶
          
            0
          
        
        ‚ü©
        
          Œ¶
          
            0
          
        
        =
        0
        
        ‚üπ
        
        
          
            
              
                H
                ^
              
            
          
          
            0
          
        
        
          Œ¶
          
            0
          
        
        =
        ‚ü®
        
          Œ¶
          
            0
          
        
        
          |
        
        
          
            
              H
              ^
            
          
        
        
          |
        
        
          Œ¶
          
            0
          
        
        ‚ü©
        
          Œ¶
          
            0
          
        
        ,
      
    
    {\displaystyle {\hat {F}}\Phi _{0}-\langle \Phi _{0}|{\hat {F}}|\Phi _{0}\rangle \Phi _{0}=0\implies {\hat {H}}_{0}\Phi _{0}=\langle \Phi _{0}|{\hat {H}}|\Phi _{0}\rangle \Phi _{0},}
  i.e. the zeroth-order energy is the expectation value of 
  
    
      
        
          
            
              H
              ^
            
          
        
      
    
    {\displaystyle {\hat {H}}}
   with respect to Œ¶0, the Hartree-Fock energy. Similarly, it can be seen that in this formulation the MP1 energy

  
    
      
        
          E
          
            MP1
          
        
        ‚â°
        ‚ü®
        
          Œ¶
          
            0
          
        
        
          |
        
        
          
            
              V
              ^
            
          
        
        
          |
        
        
          Œ¶
          
            0
          
        
        ‚ü©
        =
        0
      
    
    {\displaystyle E_{\text{MP1}}\equiv \langle \Phi _{0}|{\hat {V}}|\Phi _{0}\rangle =0}
  .Hence, the first meaningful correction appears at MP2 energy.
In order to obtain the MP2 formula for a closed-shell molecule, the second order RS-PT formula is written in a basis of doubly excited Slater determinants.  (Singly excited Slater determinants do not contribute because of the Brillouin theorem).  After application of the Slater‚ÄìCondon rules for the simplification of N-electron matrix elements with Slater determinants in bra and ket and integrating out spin, it becomes

  
    
      
        
          
            
              
                
                  E
                  
                    MP2
                  
                
              
              
                
                =
                2
                
                  ‚àë
                  
                    i
                    ,
                    j
                    ,
                    a
                    ,
                    b
                  
                
                
                  
                    
                      ‚ü®
                      
                        œÜ
                        
                          i
                        
                      
                      
                        œÜ
                        
                          j
                        
                      
                      
                        |
                      
                      
                        
                          
                            
                              
                                v
                                ~
                              
                            
                            ^
                          
                        
                      
                      
                        |
                      
                      
                        œÜ
                        
                          a
                        
                      
                      
                        œÜ
                        
                          b
                        
                      
                      ‚ü©
                      ‚ü®
                      
                        œÜ
                        
                          a
                        
                      
                      
                        œÜ
                        
                          b
                        
                      
                      
                        |
                      
                      
                        
                          
                            
                              
                                v
                                ~
                              
                            
                            ^
                          
                        
                      
                      
                        |
                      
                      
                        œÜ
                        
                          i
                        
                      
                      
                        œÜ
                        
                          j
                        
                      
                      ‚ü©
                    
                    
                      
                        Œµ
                        
                          i
                        
                      
                      +
                      
                        Œµ
                        
                          j
                        
                      
                      ‚àí
                      
                        Œµ
                        
                          a
                        
                      
                      ‚àí
                      
                        Œµ
                        
                          b
                        
                      
                    
                  
                
                ‚àí
                
                  ‚àë
                  
                    i
                    ,
                    j
                    ,
                    a
                    ,
                    b
                  
                
                
                  
                    
                      ‚ü®
                      
                        œÜ
                        
                          i
                        
                      
                      
                        œÜ
                        
                          j
                        
                      
                      
                        |
                      
                      
                        
                          
                            
                              
                                v
                                ~
                              
                            
                            ^
                          
                        
                      
                      
                        |
                      
                      
                        œÜ
                        
                          a
                        
                      
                      
                        œÜ
                        
                          b
                        
                      
                      ‚ü©
                      ‚ü®
                      
                        œÜ
                        
                          a
                        
                      
                      
                        œÜ
                        
                          b
                        
                      
                      
                        |
                      
                      
                        
                          
                            
                              
                                v
                                ~
                              
                            
                            ^
                          
                        
                      
                      
                        |
                      
                      
                        œÜ
                        
                          j
                        
                      
                      
                        œÜ
                        
                          i
                        
                      
                      ‚ü©
                    
                    
                      
                        Œµ
                        
                          i
                        
                      
                      +
                      
                        Œµ
                        
                          j
                        
                      
                      ‚àí
                      
                        Œµ
                        
                          a
                        
                      
                      ‚àí
                      
                        Œµ
                        
                          b
                        
                      
                    
                  
                
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}E_{\text{MP2}}&=2\sum _{i,j,a,b}{\frac {\langle \varphi _{i}\varphi _{j}|{\hat {\tilde {v}}}|\varphi _{a}\varphi _{b}\rangle \langle \varphi _{a}\varphi _{b}|{\hat {\tilde {v}}}|\varphi _{i}\varphi _{j}\rangle }{\varepsilon _{i}+\varepsilon _{j}-\varepsilon _{a}-\varepsilon _{b}}}-\sum _{i,j,a,b}{\frac {\langle \varphi _{i}\varphi _{j}|{\hat {\tilde {v}}}|\varphi _{a}\varphi _{b}\rangle \langle \varphi _{a}\varphi _{b}|{\hat {\tilde {v}}}|\varphi _{j}\varphi _{i}\rangle }{\varepsilon _{i}+\varepsilon _{j}-\varepsilon _{a}-\varepsilon _{b}}}\\\end{aligned}}}
  where ùúëi and ùúëj are canonical occupied orbitals and ùúëa and ùúëb are virtual (or unoccupied) orbitals.  The quantities Œµi, Œµj, Œµa, and Œµb are the corresponding orbital energies. Clearly, through second-order in the correlation potential, the total electronic energy is given by the Hartree‚ÄìFock energy plus second-order MP correction: E ‚âà EHF + EMP2.  The solution of the zeroth-order MP equation (which by definition is the Hartree‚ÄìFock equation) gives the Hartree‚ÄìFock energy. The first non-vanishing perturbation correction beyond the Hartree‚ÄìFock treatment is the second-order energy.


=== Alternative formulation ===
Equivalent expressions are obtained by a slightly different partitioning of the Hamiltonian, which results in a different division of energy terms over zeroth- and first-order contributions, while for second- and higher-order energy corrections the two partitionings give identical results.  The formulation is commonly used by chemists, who are now large users of these methods.  This difference is due to the fact, well known in Hartree‚ÄìFock theory, that

  
    
      
        ‚ü®
        
          Œ¶
          
            0
          
        
        
          |
        
        (
        
          
            
              H
              ^
            
          
        
        ‚àí
        
          
            
              F
              ^
            
          
        
        )
        
          |
        
        
          Œ¶
          
            0
          
        
        ‚ü©
        ‚â†
        0
        
        ‚ü∫
        
        
          E
          
            HF
          
        
        ‚â†
        2
        
          ‚àë
          
            i
            =
            1
          
          
            N
            
              /
            
            2
          
        
        
          Œµ
          
            i
          
        
        .
      
    
    {\displaystyle \langle \Phi _{0}|({\hat {H}}-{\hat {F}})|\Phi _{0}\rangle \neq 0\qquad \Longleftrightarrow \qquad E_{\text{HF}}\neq 2\sum _{i=1}^{N/2}\varepsilon _{i}.}
  (The Hartree‚ÄìFock energy is not equal to the sum of occupied-orbital energies).  In the alternative partitioning, one defines

  
    
      
        
          
            
              
                H
                ^
              
            
          
          
            0
          
        
        ‚â°
        
          
            
              F
              ^
            
          
        
        ,
        
        
          
            
              V
              ^
            
          
        
        ‚â°
        
          
            
              H
              ^
            
          
        
        ‚àí
        
          
            
              F
              ^
            
          
        
        .
      
    
    {\displaystyle {\hat {H}}_{0}\equiv {\hat {F}},\qquad {\hat {V}}\equiv {\hat {H}}-{\hat {F}}.}
  Clearly, in this partitioning,

  
    
      
        
          E
          
            MP0
          
        
        =
        2
        
          ‚àë
          
            i
            =
            1
          
          
            N
            
              /
            
            2
          
        
        
          Œµ
          
            i
          
        
        ,
        
        
          E
          
            MP1
          
        
        =
        
          E
          
            HF
          
        
        ‚àí
        2
        
          ‚àë
          
            i
            =
            1
          
          
            N
            
              /
            
            2
          
        
        
          Œµ
          
            i
          
        
        .
      
    
    {\displaystyle E_{\text{MP0}}=2\sum _{i=1}^{N/2}\varepsilon _{i},\qquad E_{\text{MP1}}=E_{\text{HF}}-2\sum _{i=1}^{N/2}\varepsilon _{i}.}
  Obviously, with this alternative formulation, the M√∏ller‚ÄìPlesset theorem does not hold in the literal sense that EMP1 ‚â† 0.  The solution of the zeroth-order MP equation is the sum of orbital energies.  The zeroth plus first-order correction yields the Hartree‚ÄìFock energy.  As with the original formulation, the first non-vanishing perturbation correction beyond the Hartree‚ÄìFock treatment is the second-order energy.  To reiterate, the second- and higher-order corrections are the same in both formulations.


== Use of M√∏ller‚ÄìPlesset perturbation methods ==
Second (MP2), third (MP3), and fourth (MP4) order M√∏ller‚ÄìPlesset calculations are standard levels used in calculating small systems and are implemented in many computational chemistry codes. Higher level MP calculations, generally only MP5, are possible in some codes. However, they are rarely used because of their cost.
Systematic studies of MP perturbation theory have shown that it is not necessarily a convergent theory at high orders. Convergence  can be slow, rapid, oscillatory, regular, highly erratic or simply non-existent, depending on the precise chemical system or basis set.
The density matrix for the first-order and higher MP2 wavefunction  is of the
type known as response density, which differs from the
more usual expectation value density.  The eigenvalues of
the response density matrix (which are the occupation numbers of the MP2 natural orbitals) can therefore be greater than 2 or negative.  Unphysical numbers are a sign of a divergent perturbation expansion.Additionally, various important molecular properties calculated at MP3 and MP4 level are no better than their MP2 counterparts, even for small molecules.For open shell molecules, MPn-theory can directly be applied only to unrestricted Hartree‚ÄìFock reference functions (since UHF states are not in general eigenvectors of the Fock operator). However, the resulting energies often suffer from severe spin contamination, leading to large errors. A possible better alternative is to use one of the MP2-like methods based on restricted open-shell Hartree‚ÄìFock (ROHF).  Unfortunately, there are many ROHF based MP2-like methods because of arbitrariness in the ROHF wavefunction(for example HCPT, ROMP, RMP (also called  ROHF-MBPT2), OPT1 and OPT2, ZAPT, IOPT, etc.).  Some of the ROHF based MP2-like theories suffer from spin-contamination in their perturbed density and energies beyond second-order.These methods, Hartree‚ÄìFock, unrestricted Hartree‚ÄìFock and restricted Hartree‚ÄìFock use a single determinant wave function. Multi-configurational self-consistent field (MCSCF) methods use several determinants and can be used for the unperturbed operator, although not uniquely, so many methods, such as complete active space perturbation theory (CASPT2), and Multi-Configuration Quasi-Degenerate Perturbation
Theory (MCQDPT), have been developed.  Unfortunately,  MCSCF based methods are not without perturbation series divergences.


== See also ==
Electron correlation
Perturbation theory (quantum mechanics)
Post-Hartree‚ÄìFock
List of quantum chemistry and solid state physics software


== References ==


== Further reading ==
Cramer, Christopher J. (2002). Essentials of Computational Chemistry. Chichester: John Wiley & Sons, Ltd. pp. 207‚Äì211. ISBN 978-0-471-48552-0.
Foresman, James B.; √Üleen Frisch (1996). Exploring Chemistry with Electronic Structure Methods. Pittsburgh, PA: Gaussian Inc. pp. 267‚Äì271. ISBN 978-0-9636769-4-8.
Leach, Andrew R. (1996). Molecular Modelling. Harlow: Longman. pp. 83‚Äì85. ISBN 978-0-582-23933-3.
Levine, Ira N. (1991). Quantum Chemistry. Englewood Cliffs, New jersey: Prentice Hall. pp. 511‚Äì515. ISBN 978-0-205-12770-2.
Szabo, Attila; Neil S. Ostlund (1996). Modern Quantum Chemistry. Mineola, New York: Dover Publications, Inc. pp. 350‚Äì353. ISBN 978-0-486-69186-2.