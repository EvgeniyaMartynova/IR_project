Title: Express Data Path
Aspects: {'XDP'}

XDP (eXpress Data Path) is an eBPF based high performance data path merged in the Linux kernel since version 4.8.The idea behind XDP is to add an early hook in the RX path of the kernel, and let a user supplied eBPF program decide the fate of the packet. The hook is placed in the NIC driver just after the interrupt processing, and before any memory allocation needed by the network stack itself, because memory allocation can be an expensive operation. Due to this design, XDP can drop 26 millions of packets per second per core with commodity hardware.The eBPF program must pass a preverifier test before being loaded, to avoid executing malicious code in kernel space. The preverifier checks that the program contains no out-of-bounds accesses, loops or global variables.

The program is allowed to edit the packet data and, after the eBPF program returns, an action code determines what to do with the packet:

let the packet continue through the network stack
silently drop the packet
bounce the packet back to the same NIC it arrived on
send the packet to a user space socket via the AF_XDP address familyXDP requires support in the NIC driver but, as not all drivers supports it, it can fallback to a generic implementation, which performs the eBPF processing in the network stack, though with slower performances.XDP has infrastructure to offload the eBPF program to a NIC card which supports it, reducing the CPU load. At the time only Netronome cards supports it, with Intel and Mellanox working on it.


== AF_XDP ==
Along with XDP, a new address family entered in the Linux kernel starting 4.18. AF_XDP, formerly known as AF_PACKETv4 (which was never included in the mainline kernel), is a raw socket optimized for high performance packet processing and allows zero-copy between kernel and applications. As the socket can be used for both receiving and transmitting, it allows to write high performance network applications purely in user space.


== References ==


== External links ==
XDP documentation on Read the Docs
AF_XDP documentation on kernel.org
XDP walkthrough at FOSDEM 2017 by Daniel Borkmann, Cilium
AF_XDP at FOSDEM 2018 by Magnus Karlsson, Intel
L4Drop: XDP DDoS Mitigations, Cloudflare
Open-sourcing Katran, a scalable network load balancer, Facebook